# Центральные устройства ЭВМ
## Основная память
> [!summary] Запоминающее устройство
> Комплекс технических средств, реализующих функцию памяти, называется **запоминающим устройством** (ЗУ). ЗУ необходимы для размещения в них команд и данных. Они обеспечивают центральному процессору доступ к программам и информации.

Запоминающие устройства делятся на:
- основную память
	- ОЗУ или RAM - Random Access Memory
	- ПЗУ или ROM - Read Only Memory
- сверхоперативную память (СОЗУ)
- внешние запоминающие устройства.

**ОЗУ** предназначено **для хранения переменной информации**. Оно допускает изменение своего содержимого в ходе выполнения процессором вычислительных операций с данными и **может работать в режимах записи, чтения, хранения**.

**ПЗУ** **содержит информацию, которая не должна изменяться в ходе выполнения** процессором вычислительных **операций**, например стандартные программы и константы. Эта информация заносится в ПЗУ перед установкой микросхемы в ЭВМ. Основными операциями, которые может выполнять ПЗУ, являются **чтение и хранение**.

**Функциональные возможности ОЗУ шире**, чем ПЗУ Но **ПЗУ сохраняет информацию при отключении питания** (т.е. является энергонезависимой памятью) и **может иметь более высокое быстродействие**, так как ограниченность функциональных возможностей ПЗУ и его специализация на чтении и хранении позволяют сократить время выполнения реализуемых им операций считывания.

В современных ЭВМ микросхемы памяти (ОП и СОЗУ) изготавливают из кремния по полупроводниковой технологии с высокой степенью интеграции элементов на кристалле (микросхемы памяти относятся к так называемым “регулярным” схемам, что позволяет сделать установку элементов памяти в кристалле (чипе) настолько плотной, что размеры элементов памяти становятся сопоставимыми с размерами отдельных атомов).

**Основной** составной **частью** микросхемы **является массив элементов памяти** (ЭП), объединенных в матрицу накопителя.

Каждый элемент памяти может хранить 1 бит информации и имеет свой адрес. ЗУ, позволяющие обращаться по адресу к любому ЭП в произвольном порядке, называются **запоминающими устройствами с произвольным доступом.**

> [!summary] ЗУ с произвольным доступом
> это ЗУ позволяющие обращаться по адресу к любому ЭП в произвольном порядке.

При матричной организации памяти реализуется **координатный принцип адресации ЭП**, в связи с чем адрес делится на две части (две координаты) - **Х и Y**. На пересечении этих координат находится элемент памяти, чья информация должна быть прочитана или изменена.

ОЗУ связано с остальным микропроцессорным комплектом ЭВМ через системную [Магистраль — системная шина](http://komputercnulja.ru/sistem_blok/magistral-sistemnaya-shina "Постоянная ссылка на Магистраль — системная шина") (рис.1).

СТРУКТУРНАЯ СХЕМА ОЗУ
![[ozu_pic.png]]
***
Микросхемы памяти могут строиться на **статических (S**RAM) и **динамических (D**RAM) ЭП.

В качестве статического ЭП чаще всего выступает статический триггер.
В качестве динамического ЭП может использоваться электрический конденсатор, сформированный внутри кремниевого кристалла.

**Статические ЭП способны сохранять свое состояние (0 или 1)** неограниченно долго (при включенном питании). **Динамические ЭП** с течением времени записанную в них информацию теряют (например, из-за саморазряда конденсатора), поэтому они **нуждаются**в периодическом восстановлении записанной в них информации - **в регенерации**.

**Микросхемы** элементов памяти **динамических ОЗУ** **отличаются** от аналогичных ЭП статических ОЗУ **меньшим числом компонентов в одном элементе памяти**, в связи с чем имеют меньшие размеры и могут быть более плотно упакованы в кристалле. **Однако** из-за необходимости регенерации информации динамические ОЗУ **имеют более сложные схемы управления**.

Основными характеристиками ОЗУ являются:
- объем
- быстродействие.

В современных ПЭВМ ОЗУ имеет модульную структуру. Сменные модули могут иметь различное конструктивное исполнение (SIMM, DIMM). Увеличение объема ОЗУ обычно связано с установкой дополнительных модулей, которые выпускаются в 30-контактном (30-pin) и 72-контактном исполнениях на 1,4, 8, 16, 32 и 64 Мбайта. Время доступа к модулям DRAM составляет 60 - 70 нс.

На производительность ЭВМ влияет не только время доступа, но и такие параметры (связанные с ОЗУ), как тактовая частота и разрядность шины данных системной магистрали. Если **тактовая частота недостаточно высока**, то ОЗУ простаивает в ожидании обращения. При **тактовой частоте, превышающей возможности** ОЗУ, в ожидании будет находиться системная магистраль, через которую поступил запрос в ОЗУ.
**Разрядность шины данных** (8, 16, 32 или 64 бита) **определяет длину информационной единицы**, которой можно обменяться с ОЗУ **за одно обращение**.

**Интегральной характеристикой производительности ОЗУ** с учетом частоты и разрядности **является пропускная способность**, которая измеряется в Мегабайтах в секунду. Для ОП с временем доступа 60-70 не и разрядностью шины данных 64 бита максимальная (теоретическая) пропускная способность при тактовой частоте СМ 50 МГц составляет 400 Мбайт/с, при частоте 60 МГц - 480 Мбайт/с, при 66 МГц - 528 Мбайт/с в режиме группового обмена, реализуемом, например, при прямом доступе к памяти. Для группового обмена характерно (и это является еще одной характеристикой ОЗУ), что при каждом обращении к памяти для считывания первого слова необходимо больше времени, чем для последующих.

Синхронная динамическая память (**SDR**AM - Synchronous DRAM) способна обмениваться блоками данных на рабочей тактовой частоте (внешняя частота процессора) без циклов ожидания: при времени доступа 10 не - до 100 МГц, 12 нс - до 83МГц 15 нс - до 66 МГц.

Микросхемы ПЗУ также построены по принципу матричной структуры накопителя. Функции элементов памяти в них выполняют перемычки в виде проводников, полупроводниковых диодов или транзисторов. В такой матрице наличие перемычки может означать “I”, а ее отсутствие - “О”. **Занесение формации** в микросхему ПЗУ **называется ее программированием**, а **устройство, с помощью которого заносится информация**, - **программатором**.

**Программирование ПЗУ заключается в устранении** (прожигании) **перемычек** по тем адресам, где должен храниться “О”. Обычно схемы ПЗУ допускают только одно программирование, но специальные микросхемы - ре-программируемые **ПЗУ (РПЗУ)** - допускают их многократное стирание и занесение новой информации. **Этот вид микросхем также относится к энергозависимым, т.е. может длительное время сохранять информацию при выключенном питании** (стирание микросхемы происходит либо за счет подачи специального стирающего напряжения, либо за счет воздействия на кристалл ультрафиолетового излучения, для этого в корпусе микросхемы оставляется прозрачное окно).

**Сверхоперативные ЗУ используются для хранения небольших объемов формации** и имеют значительно меньшее время (в 2 - 10 раз) считывания/записи, чем основная память. **СОЗУ обычно строятся на регистрах и регистровых структурах**.

**Регистр** представляет собой **электронное устройство, способное хранить внесенное в него число неограниченно долго (при включенном питании)**. Наибольшее распространение получили регистры на статических триггерах.

По назначению регистры делятся на
- регистры хранения
- регистры сдвига

**Информация в регистры может заноситься и считываться либо параллельно, сразу всеми разрядами, либо последовательно**, через один из крайних разрядов с последующим сдвигом занесенной информации.

Сдвиг записанной в регистр информации может производиться **вправо или влево**. 

> [!summary] Реверсивный регистр
> Реверсивным регистром называется регистр, который допускает **сдвиг информации в любом направлении.**

Регистры **могут быть объединены в единую структуру**. Возможности такой структуры определяются способом доступа и адресации регистров.

**Если** к любому регистру **можно обратиться для записи/чтения по его адресу**, такая регистровая структура образует **СОЗУ с произвольным доступом**.

Безадресные регистровые структуры могут образовывать два вида устройств памяти: 
- магазинного типа
- память с выборкой по содержанию (ассоциативные ЗУ).

Память магазинного типа образуется из последовательно соединенных регистров (рис. 2).
![[register_connection.png]]

**Если запись** в регистровую структуру (рис.2.а) **производится через один регистр, а считывание - через другой**, то такая память является аналогом линии задержки и **работает по принципу** “первым вошел - первым вышел” (**FIFO** - first input, first output).

**Если же запись и чтение осуществляются через один и тот же регистр** (рис.2.б), такое устройство называется **_стековой памятью**,_ работающей по принципу “первым, вошел — последним вышел” (**FILO** - first input, last output).
***
Стековая память получила широкое распространение. Для ее реализации в ЭВМ разработаны специальные микросхемы. Но часто работа стековой памяти **_эмулируется_** в основной памяти ЭВМ: с помощью программ операционной системы выделяется часть памяти под стек (в IBM PC для этой цели выделяется 64 Кбайта). Специальный регистр микропроцессора (указатель стека) постоянно хранит адрес ячейки ОП, выполняющей функции вершины стека. Чтение числа всегда производится из вершины стека, после чего указатель стека изменяется и указывает на очередную ячейку стековой памяти (т.е. фактически стек остается неподвижным, а перемещается вершина стека). При записи числа в стек сначала номер ячейки в указателе стека модифицируется так, чтобы он указывал на очередную свободную ячейку, после чего производится запись числа по этому адресу. Такая работа указателя стека позволяет реализовать принцип “**первым вошел - последним вышел**”. В стек может быть загружен в определенной последовательности ряд данных, которые впоследствии считываются из стека уже в обратном порядке, **на этом свойстве построена система арифметических преобразований информации**.

> [!attention] Память с выборкой по содержанию
> Память с выборкой по содержанию является безадресной.

Обращение к ней осуществляется по специальной маске, которая содержит поисковый образ. Информация считывается из памяти, если часть ее соответствует поисковому образу, зафиксированному в маске. Например, если в такую память записана информация, содержащая данные о месте жительства (включая город), и необходимо найти сведения о жителях определенного города, то название этого города помещается в маску и дается команда **чтение** - из памяти выбираются все записи, относящиеся к заданному городу.

**В микропроцессорах ассоциативные ЗУ используются в составе кэш-памяти для хранения адресной части команд и операндов исполняемой программы**. При этом нет необходимости обращаться к ОП за следующей командой или требуемым операндом: достаточно поместить в маску необходимый адрес, если искомая информация имеется в СОЗУ, то она будет сразу выдана. Обращение к ОП будет необходимо лишь при отсутствии требуемой информации в СОЗУ. За счет такого использования СОЗУ сокращается число обращений к ОП, а это позволяет экономить время, так как обращение к СОЗУ требует в 2 - 10 раз меньше времени, чем обращение к ОП.

Кэш-память может быть размещена **в кристалле процессора (так называемая “кэш-память I уровня”)** или выполнена в **виде отдельной микросхемы (внешняя кэш-память или кэш-память II уровня)**. Встроенная кэш-память (I уровня) в процессорах Pentium имеет объем около 16 Кбайт, время доступа - 5 - 10 не, работает с 32-битными словами и при частотах 75-166 МГц обеспечивает пропускную способность от 300 до 667 Мбайт/с. Внешняя кэш-память (П уровня) имеет объем 256 Кбайт - 1 Мбайт, время доступа - 15 не, работает с 64-битными словами и при частоте 66 МГц обеспечивает максимальную пропускную способность 528 Мбайт/с. Конструктивно исполняется либо в виде 28-контактной микросхемы, либо в виде модуля расширения на 256 или 512 Кбайт.

Размещение информации в основной памяти IBM PC.
Адресуемой **единицей информации** основной памяти **IBM PC является байт**. Это означает, что **каждый байт**, записанный в ОП, **имеет уникальный номер (адрес)**. При использовании 20-битной шины адреса абсолютный (физический) **адрес каждого байта является пятиразрядным шестнадцатеричным числом**, принимающим значения от 00000 до FFFFF.

В младших адресах располагаются блоки операционной системы (векторы прерываний, зарезервированная область памяти BIOS), в этой же части могут размещаться драйверы устройств, дополнительные обработчики прерываний DOS и BIOS, командный процессор операционной системы. Затем располагается область памяти, отведенная пользователю. **Область памяти пользователя заканчивается адресом 9FFFF. Этот адрес является физической границей оперативного ЗУ**, последним адресом 640-Кбайтной основной памяти. Остальное адресное пространство (128 Кбайт с адреса АОООО по BFFFF) отведено под видеопамять, которая физически размещается не в ОП, а в адаптере дисплея. После видеопамяти расположено адресное пространство (256Кбайт) постоянного запоминающего устройства (ПЗУ), хранящего программы базовой системы ввода-вывода (BIOS - “Basic Input — Output System”). Эта часть ОП еще называется ROM-BIOS. Из отведенных 256 Кбайт непосредственно ПЗУ занимает 64 Кбайта, а остальные 192 Кбайт оставлены для расширения ПЗУ. Поскольку большая часть оставленной для расширения BIOS части адресного пространства не используется, в этих адресах часто располагается информация, необходимая для работы сетевых карт, графических расширителей и др.

**Запись в ОП (и чтение из нее) может осуществляться не только байтами, но и машинными словами**. При этом машинное слово при размещении в памяти занимает несколько смежных байтов. Каждый байт ОП имеет свой адрес. Но **машинное слово характеризуется** не всеми адресами занятых байтов, а только **одним - адресом младшего байта слова**. Обычно графически машинное слово изображается так, что младший байт находится.

![[machine_word.png]]

При чтении из ОП двух следующих подряд байтов машинного слова их принято размещать слева направо: сначала первый из прочитанных байтов (с меньшим адресом), а затем - следующий. В результате происходит “вращение” байтов (рис.4), которое психологически трудно воспринимается. Необходимо помнить, что при записи отдельных байтов каждый байт располагается в ОП по своему адресу, при чтении никакого вращения не происходит. При записи же в ОП единиц информации, имеющих в своем составе больше одного байта, адресом информационной единицы является адрес самого младшего байта, запись в ОП ведется побайтно, начиная с самого младшего байта, каждый последующий байт располагается в ячейке, адрес которой на 1 больше предыдущего. Иными словами, **запись машинного или двойного слова производится справа налево, тогда как при чтении считанные байты обычно располагаются слева направо - происходят “вращение” байтов, перестановка их местами**, что необходимо учитывать при работе с ОП на физическом уровне.

Расширение основной памяти IBM PC
Рабочая концепция фирмы IBM при создании IBM PC содержала гипотезу, что объем основной памяти ЭВМ, предназначенной для персонального использования в любой предметной области, не должен превышать 640 Кбайт. Поэтому в базовую модель IBM PC заложили 20-разрядную шину адреса системной магистрали. Наличие 20 линий в шине адреса позволяло адресовать память большего объема, чем было предусмотрено концепцией (220 = 1 Мбайт). “Излишек” адресного пространства в 384 Кбайт был поделен между видеопамятью (128 Кбайт) и ПЗУ (256 Кбайт).

Физически увеличить объем памяти несложно, для этого необходимо только подключить к системной магистрали дополнительные модули. Такая возможность в IBM PC была предусмотрена. Но каждый байт дополнительной памяти должен иметь уникальный адрес, а адресного пространства для дополнительной памяти нет.

Существует несколько способов разрешения таких конфликтов. Один из них - банкирование памяти: вся память делится на блоки (банки), емкость которых не выходит за пределы допустимого адресного пространства; во время работы специальными командами можно переключать банки, делая активным любой из них или осуществляя групповую перепись информации из одного банка в другой.