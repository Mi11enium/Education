**Nmap** (сокращение от _Network Mapper_) — это мощный инструмент для сканирования сетей и анализа их безопасности. Он позволяет обнаруживать активные устройства, открытые порты, запущенные службы и даже определять операционные системы в сети.

### **Основные возможности Nmap**
- **Сканирование сети**.
- **Определение открытых портов** — проверка, какие порты принимают подключения (например, HTTP, SSH, FTP).
- **Анализ служб и версий**
- **Обнаружение ОС**.
- **Гибкость настройки** 

Nmap — легальный инструмент, но его применение без разрешения владельца сети может нарушать законы. Рекомендуется использовать его только в рамках аудита безопасности с официальным согласием.

Порты — это как двери в доме жертвы. Хакер сканирует их, чтобы найти открытые или уязвимые, проникнуть внутрь системы и либо украсть данные, либо получить контроль.

- Если порт **22 (SSH)** открыт, пробуют **брутфорс** или эксплоиты для входа.
- Если порт **80 (HTTP)** или **443 (HTTPS)** — ищут уязвимые веб-приложения (SQL-инъекции, XSS).
- Если порт **445 (SMB)** — проверяют на уязвимости вроде **EternalBlue** (как в WannaCry).

### **Самые "вкусные" порты для атак**

| Порт | Услуга | Популярные атаки                         |
| ---- | ------ | ---------------------------------------- |
| 22   | SSH    | Брутфорс, эксплуатация старых версий     |
| 80   | HTTP   | SQLi, XSS, LFI/RFI                       |
| 443  | HTTPS  | TLS-уязвимости, веб-уязвимости           |
| 445  | МСБ    | EternalBlue, Передача хэша               |
| 3389 | РДП    | BlueKeep, Брутфорс                       |
| 3306 | MySQL  | SQL-инъекции, несанкционированный доступ |
| 6379 | Редис  | RCE при неправильной настройке           |

 Для хакера порты — это точки входа. Чем больше открыто и уязвимо, тем проще взломать систему.

**Мы изучим подробнее, как сканировать сайт на порты позже, и даже разберём практические примеры взлома через уязвимые сервисы. А пока запомни главное:**

### **Почему сканирование портов — первый шаг к взлому?**
1. **Это как "разведка боем"** – хакер узнаёт, какие сервисы крутятся на сервере (веб, базы данных, удалённое управление).
2. **У каждой дыры — свой порт**
3. **Скрытые "чёрные ходы"** – иногда админы оставляют **недокументированные порты** (например, 31337 – Backdoor), и их можно найти **только сканированием**.


### Пример использования
nmap scanme.nmap.org - вывод открытых портов
nmap -sV scanme.nmap.org - вывод портов с версиями сервисов

# **Шпаргалка по nmap**

## **1. Основные типы сканирования**

| Ключ                            | Описание                                                                |
| ------------------------------- | ----------------------------------------------------------------------- |
| **`-sS`**                       | **Stealth SYN Scan** (полуоткрытое сканирование, по умолчанию для root) |
| **`-sT`**                       | **TCP Connect Scan** (обычное подключение, если нет root-прав)          |
| **`-sU`**                       | **UDP Scan** (сканирование UDP-портов)                                  |
| **`-sN`**, **`-sF`**, **`-sX`** | **NULL, FIN, Xmas Scan** (хитрое сканирование для обхода фаерволов)     |
| **`-sA`**                       | **ACK Scan** (проверка, фильтруется ли порт)                            |
| **`-sV`**                       | **Version Detection** (определение версий сервисов)                     |
| **`-O`**                        | **OS Detection** (определение операционной системы)                     |
| **`-A`**                        | **Aggressive Scan** (включает `-sV`, `-O`, трассировку и скрипты)       |

## **2. Выбор портов и хостов**

| Ключ                   | Описание                                                               |
| ---------------------- | ---------------------------------------------------------------------- |
| **`-p <порты>`**       | Сканировать указанные порты (например, `-p 80,443,22-100`)             |
| **`-p-`**              | Сканировать **все 65535 портов**                                       |
| **`-F`**               | **Быстрое сканирование** (только 100 популярных портов)                |
| **`--top-ports <N>`**  | Сканировать **N самых популярных** портов (например, `--top-ports 50`) |
| **`-iL <файл>`**       | Сканировать хосты из файла                                             |
| **`--exclude <хост>`** | Исключить хост из сканирования                                         |

## **3. Настройка скорости и скрытности**

| Ключ                         | Описание                                                               |
| ---------------------------- | ---------------------------------------------------------------------- |
| **`-T0`**–**`-T5`**          | **Скорость сканирования** (`-T3` – по умолчанию, `-T5` – очень быстро) |
| **`-Pn`**                    | **Не проверять, жив ли хост** (игнорировать ping)                      |
| **`-f`**, **`--mtu <size>`** | Фрагментировать пакеты (для обхода IDS)                                |
| **`-D <decoy1,decoy2>`**     | **Маскировка сканирования** (поддельные IP в логах)                    |
| **`--spoof-mac <MAC>`**      | Подмена MAC-адреса                                                     |
| **`--data-length <байт>`**   | Добавить мусорные данные к пакетам                                     |

## **4. Вывод и сохранение результатов**

| Ключ                | Описание                                                 |
| ------------------- | -------------------------------------------------------- |
| **`-oN <файл>`**    | Сохранить в **обычный текстовый файл**                   |
| **`-oX <файл>`**    | Сохранить в **XML** (для парсинга программами)           |
| **`-oG <файл>`**    | **Grep-формат** (удобно для `grep`, `awk`)               |
| **`-oA <база>`**    | Сохранить во **все форматы** (`.nmap`, `.xml`, `.gnmap`) |
| **`-v`**, **`-vv`** | **Увеличение детализации** (verbose)                     |

## **5. Nmap Scripting Engine (NSE)**

| Ключ                            | Описание                                                          |
| ------------------------------- | ----------------------------------------------------------------- |
| **`-sC`**                       | Запустить **стандартные скрипты** (аналогично `--script=default`) |
| **`--script <скрипт>`**         | Запустить **конкретный скрипт** (например, `--script=http-title`) |
| **`--script-args <аргументы>`** | Передать параметры скрипту                                        |
| **`--script-help <скрипт>`**    | Показать справку по скрипту                                       |

## **6. Дополнительные полезные опции**

| Ключ                 | Описание                               |
| -------------------- | -------------------------------------- |
| **`--traceroute`**   | Трассировка маршрута к хосту           |
| **`-6`**             | Сканировать **IPv6**                   |
| **`--reason`**       | Показывать **причину** статуса порта   |
| **`--open`**         | Показывать **только открытые** порты   |
| **`--packet-trace`** | Логировать **все отправленные пакеты** |
