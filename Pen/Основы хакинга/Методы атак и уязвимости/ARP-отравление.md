### **ARP-отравление (ARP-spoofing)**

**Основа: Протокол ARP и его уязвимость**

Для понимания атаки необходимо вспомнить принципы работы протокола **ARP (Address Resolution Protocol)**.
- **Задача ARP:** Преобразование IP-адреса (логического адреса 3-го уровня модели OSI) в MAC-адрес (физический адрес 2-го уровня). Это необходимо, так как передача кадров данных в локальной сети (Ethernet, Wi-Fi) происходит на основе MAC-адресов, а не IP.
- **Принцип работы:** Устройство, которому нужно узнать MAC-адрес по известному IP-адресу, отправляет в сеть **broadcast-запрос (ARP Request)**. Устройство с искомым IP-адресом отвечает **unicast-ответом (ARP Reply)**, содержащим свой MAC-адрес.
- **ARP-кэш:** Для уменьшения количества запросов каждое устройство ведет локальную таблицу соответствий IP-MAC (ARP-кэш). Записи в этой таблице **непостоянны** (обновляются и могут быть перезаписаны) и, что критически важно, **не аутентифицируются**. Устройство доверяет любому корректно сформированному ARP-ответу, даже если оно его не запрашивало.

**Уязвимость:** Отсутствие механизма проверки подлинности отправителя в ARP-ответах. Это фундаментальная архитектурная слабость протокола.

**Суть атаки ARP-отравления**

**ARP-отравление** — это кибератака, при которой злоумышленник рассылает в локальную сеть поддельные (спуфингные) ARP-ответы. Цель — навязать целевым устройствам ложное соответствие IP-MAC и перенаправить трафик через себя.

Атакующее устройство (часто это компьютер злоумышленника) отправляет сфальсифицированные ARP-сообщения двум жертвам (например, Клиенту и Шлюзу по умолчанию):
1. **Жертве A (например, Клиенту):** Сообщение, что IP-адрес **Шлюза** теперь соответствует **MAC-адресу атакующего**.
2. **Жертве B (например, Шлюзу):** Сообщение, что IP-адрес **Клиента** теперь соответствует **MAC-адресу атакующего**.

**Результат:** ARP-кэши обеих жертв отравлены ложными данными. Весь трафик между Клиентом и Шлюзом начинает проходить через устройство злоумышленника, который становится **«человеком посередине» (Man-in-the-Middle, MitM)**.

**Цели и последствия атаки**

Перенаправление трафика само по себе не является конечной целью. Оно создает условия для реализации более серьезных угроз:
- **Перехват трафика (Sniffing):** Атакующий может пассивно прослушивать и анализировать весь незашифрованный сетевой трафик между жертвами (HTTP, FTP, SMTP и т.д.), получая конфиденциальные данные (логины, пароли, переписку).
- **Модификация трафика:** Активное вмешательство в передаваемые данные (подмена содержимого веб-страниц, внедрение вредоносного кода).
- **Сессионная атака:** Перехват и подмена идентификаторов сессий для получения несанкционированного доступа к учетным записям.
- **Нарушение связи (DoS):** Если атакующий не перенаправляет трафик дальше, а просто отбрасывает его, это приводит к разрыву соединения и отказу в обслуживании для жертв.